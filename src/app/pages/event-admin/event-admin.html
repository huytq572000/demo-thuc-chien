<div class="admin-container">
  <h1>Quản lý sự kiện</h1>

  <mat-card class="form-card">
    <mat-card-header>
      <mat-card-title>{{ isEditing ? 'Chỉnh sửa sự kiện' : 'Thêm sự kiện mới' }}</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="eventForm" (ngSubmit)="onSubmit()">
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Tên sự kiện</mat-label>
            <input matInput formControlName="name">
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Ngày & Giờ (YYYY-MM-DDTHH:mm:ss)</mat-label>
            <input matInput formControlName="date">
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Địa điểm</mat-label>
            <input matInput formControlName="location">
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Danh mục</mat-label>
            <input matInput formControlName="category">
          </mat-form-field>
        </div>
        <mat-form-field appearance="outline">
            <mat-label>URL Hình ảnh</mat-label>
            <input matInput formControlName="imageUrl">
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Mô tả</mat-label>
          <textarea matInput formControlName="description" rows="4"></textarea>
        </mat-form-field>
        <div class="form-actions">
          <button mat-raised-button color="primary" type="submit" [disabled]="eventForm.invalid">{{ isEditing ? 'Cập nhật' : 'Thêm mới' }}</button>
          @if (isEditing) {
            <button mat-button type="button" (click)="cancelEdit()">Hủy</button>
          }
        </div>
      </form>
    </mat-card-content>
  </mat-card>

  <h2>Danh sách sự kiện</h2>

  <table mat-table [dataSource]="events" class="mat-elevation-z8 event-table">

    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef> Tên sự kiện </th>
      <td mat-cell *matCellDef="let event"> {{event.name}} </td>
    </ng-container>

    <ng-container matColumnDef="date">
      <th mat-header-cell *matHeaderCellDef> Thời gian </th>
      <td mat-cell *matCellDef="let event"> {{event.date | date: 'dd/MM/yyyy HH:mm'}} </td>
    </ng-container>

    <ng-container matColumnDef="location">
      <th mat-header-cell *matHeaderCellDef> Địa điểm </th>
      <td mat-cell *matCellDef="let event"> {{event.location}} </td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef> Hành động </th>
      <td mat-cell *matCellDef="let event">
        <button mat-icon-button color="primary" (click)="editEvent(event)">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button color="warn" (click)="deleteEvent(event.id)">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>
